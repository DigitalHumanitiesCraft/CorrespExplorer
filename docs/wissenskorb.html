<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Wissenskorb - Sammlung ausgewählter Personen für vergleichende Analyse">
    <title>Wissenskorb - HerData</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/search.css">
    <link rel="stylesheet" href="css/basket.css">
    <link rel="stylesheet" href="css/network.css">
</head>
<body>
    <!-- Global Navigation Placeholder -->
    <div id="navbar-placeholder"></div>

    <div class="app-container">
        <main class="main-layout">
            <!-- Left: Filter Panel -->
            <aside class="filter-panel">
                <!-- Stats Cards -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-value" id="basket-count-display">0</div>
                        <div class="stat-label">Personen</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-senders">0</div>
                        <div class="stat-label">Absenderinnen</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-mentioned">0</div>
                        <div class="stat-label">Erwähnte</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-relationships">0</div>
                        <div class="stat-label">Beziehungen</div>
                    </div>
                </div>

                <div class="filter-section">
                    <h3>Rolle</h3>
                    <div class="filter-group">
                        <label><input type="checkbox" name="role-filter" value="sender" checked> Absenderin</label>
                        <label><input type="checkbox" name="role-filter" value="mentioned" checked> Erwähnt</label>
                        <label><input type="checkbox" name="role-filter" value="both" checked> Beides</label>
                        <label><input type="checkbox" name="role-filter" value="indirect" checked> Nur SNDB</label>
                    </div>
                </div>

                <div class="filter-section">
                    <h3>Netzwerk-Modus</h3>
                    <div class="filter-group">
                        <button class="network-mode-btn active" data-mode="agrelon">
                            <i class="fas fa-users"></i>
                            <span>AGRELON Beziehungen</span>
                        </button>
                        <button class="network-mode-btn" data-mode="places">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Gemeinsame Orte</span>
                        </button>
                        <button class="network-mode-btn" data-mode="occupations">
                            <i class="fas fa-briefcase"></i>
                            <span>Gemeinsame Berufe</span>
                        </button>
                    </div>
                </div>

                <div class="filter-section">
                    <h3>Anzeige</h3>
                    <div class="filter-group">
                        <label><input type="checkbox" id="filter-only-connected" checked> Nur Personen mit Verbindungen</label>
                        <label><input type="checkbox" id="filter-has-relationships" checked> Mit AGRELON Beziehungen</label>
                        <label><input type="checkbox" id="filter-no-relationships" checked> Ohne AGRELON Beziehungen</label>
                    </div>
                </div>

                <div class="filter-section">
                    <h3>Aktionen</h3>
                    <div class="basket-actions">
                        <button id="export-csv" class="btn-export" title="Exportiere als CSV-Tabelle">
                            <i class="fas fa-file-csv"></i>
                            <span>CSV Export</span>
                        </button>
                        <button id="export-json" class="btn-export" title="Exportiere als JSON-Datei">
                            <i class="fas fa-file-code"></i>
                            <span>JSON Export</span>
                        </button>
                        <button id="clear-basket" class="btn-clear" title="Alle Personen aus dem Korb entfernen">
                            <i class="fas fa-trash"></i>
                            <span>Alle entfernen</span>
                        </button>
                    </div>
                </div>

                <!-- Context Info -->
                <div class="filter-section sidebar-info">
                    <h3>Ueber diese Funktion</h3>
                    <p class="info-text">
                        Sammeln Sie Personen aus verschiedenen Ansichten fuer vergleichende Analysen.
                    </p>
                    <h3>Interaktion</h3>
                    <ul class="info-list">
                        <li>Netzwerk zeigt Beziehungen</li>
                        <li>Export als CSV oder JSON</li>
                        <li>Personen per Stern hinzufuegen</li>
                    </ul>
                </div>
            </aside>

            <!-- Right: Detail Panel -->
            <section class="detail-panel">
                <!-- Network Visualization -->
                <div class="basket-section">
                    <h2>Beziehungsnetzwerk</h2>
                    <p class="section-description">
                        Visualisierung der Verbindungen zwischen den Personen in Ihrer Sammlung
                    </p>
                    <div id="network-graph" class="network-container">
                        <div class="empty-state">
                            <i class="fas fa-project-diagram" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                            <p>Fügen Sie Personen hinzu um Beziehungen zu sehen</p>
                        </div>

                        <!-- Network Navigation Controls -->
                        <div id="network-controls" class="network-controls" style="display: none;">
                            <button id="network-zoom-in" class="network-control-btn" title="Vergrößern">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button id="network-zoom-out" class="network-control-btn" title="Verkleinern">
                                <i class="fas fa-minus"></i>
                            </button>
                            <button id="network-fit" class="network-control-btn" title="An Ansicht anpassen">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button id="network-help" class="network-control-btn" title="Hilfe">
                                <i class="fas fa-question"></i>
                            </button>
                        </div>
                    </div>
                    <!-- Network Legend -->
                    <div id="network-legend" class="network-legend" style="display: none;">
                        <span class="legend-item"><span class="legend-dot" style="background-color: #3498db;"></span> Absenderin</span>
                        <span class="legend-item"><span class="legend-dot" style="background-color: #e67e22;"></span> Erwähnt</span>
                        <span class="legend-item"><span class="legend-dot" style="background-color: #9b59b6;"></span> Beides</span>
                        <span class="legend-item"><span class="legend-dot" style="background-color: #95a5a6;"></span> Indirekt</span>
                    </div>
                </div>

                <!-- Person Table -->
                <div class="data-table-container">
                    <div class="table-header">
                        <h2>Personen im Wissenskorb <span id="list-count" class="list-count">(0)</span></h2>
                        <input
                            type="text"
                            id="basket-search"
                            class="table-search-input"
                            placeholder="Suchen..."
                            aria-label="Person suchen"
                        />
                    </div>
                    <div class="table-wrapper">
                        <table id="basket-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Lebensdaten</th>
                                    <th>Rolle</th>
                                    <th>Berufe</th>
                                    <th>Beziehungen</th>
                                    <th>Aktionen</th>
                                </tr>
                            </thead>
                            <tbody id="basket-table-body">
                                <tr class="empty-row">
                                    <td colspan="6" class="empty-state">
                                        <i class="fas fa-bookmark" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                                        <p>Noch keine Personen im Wissenskorb</p>
                                        <p class="empty-state-hint">
                                            Fügen Sie Personen aus der
                                            <a href="index.html">Karte</a>,
                                            <a href="synthesis.html">Personenliste</a> oder dem
                                            <a href="stats.html">Brief-Explorer</a> hinzu.
                                        </p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>

    </div>

    <!-- Load basket manager first -->
    <script src="js/basket-manager.js"></script>
    <!-- Cytoscape.js for network visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
    <!-- Then load page logic -->
    <script type="module" src="js/wissenskorb.js"></script>
</body>
</html>
